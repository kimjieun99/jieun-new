<!DOCTYPE html>
<html
  lang="en"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  xmlns:th="http://www.thymeleaf.org"
  layout:decorate="~{/layout/layout.html}"
>
  <head>
    <title>VIEW PACKAGE DETAILS</title>
  </head>
  <body>
    <div
      class="packageContainer"
      id="contents"
      layout:fragment="contents"
    >
    <div id="sending">
        <h2>
          <span style="font-size:40px; font-weight: 700; color:black" class="mb-5" th:text="${pkgDto.pkgName}">View Package Details</span>
          <th:block th:each="num: ${#numbers.sequence(1,pkgDto.ratedStar)}">
            <span class="star" style="color:#ccac00; font-size:40px;">★</span>
          </th:block>
        </h2>
        <div class="container">
          <div class="row">
              <div class="col" style="width: 20%;" >
                      <img th:src="@{|/upload/${pkgDto.pkgMainRenamedPath}|}" class="card-img-top" alt="..." style="width: 32rem; height: 28rem;">
                      <div class="card-body">
                  </div>
              </div>
              <div class="col" style="width: 80%;
              display: flex;
              align-items: center;">

                  <table class="table" style="width:40vw; font-size: 16px; height: 40vh; margin-left: 100px; margin-bottom: 30px;">
                    <thead class="table-dark">
                    </thead>
                    <tbody>
                      <colgroup>
                      <col style="width:20%">
                      <col style="width:80%;">
                      </colgroup>
                      <tr>
                          <td style="font-size: 14px;"><strong>Package No</strong></td>
                          <td th:text="${pkgDto.pkgNo}"></td>
                      </tr>
                      <tr>
                          <td style="font-size: 14px;"><strong>Rating</strong></td>
                            <td style="text-align:start;">ㅤㅤㅤ<strong>General Service</strong>ㅤㅤㅤㅤㅤㅤ&nbsp;&nbsp;
                              <th:block th:each="num: ${#numbers.sequence(1,pkgDto.ratedGS)}">
                                <span class="star" style="color:#ccac00; ">★</span>
                              </th:block>
                              <br>ㅤㅤㅤ<strong>Food & Accommodation</strong>&nbsp;ㅤㅤ
                              <th:block th:each="num: ${#numbers.sequence(1,pkgDto.ratedFA)}">
                                <span class="star" style="color:#ccac00; ">★</span>
                              </th:block>
                              <br>ㅤㅤㅤ<strong>Cost-Effectiveness</strong>ㅤㅤㅤㅤ&nbsp;&nbsp;&nbsp;
                              <th:block th:each="num: ${#numbers.sequence(1,pkgDto.ratedCE)}">
                                <span class="star" style="color:#ccac00; ">★</span>
                              </th:block>
                            </td>
                        </tr>
                        <tr>
                          <td style="font-size: 14px;"><strong>Region</strong></td>
                          <td th:text="${pkgDto.pkgRegion}"></td>
                        </tr>
                        <tr>
                          <td style="font-size: 14px;"><strong>Budget</strong></td>
                          <td th:text="${pkgDto.pkgBudget}"></td>
                        </tr>
                        <tr>
                          <td style="font-size: 14px;"><strong>Departure Date</strong></td>
                          <td th:text="${pkgDto.pkgDepart}"></td>
                        </tr>
                        <tr>
                          <td style="font-size: 14px;"><strong>Return Date</strong></td>
                          <td th:text="${pkgDto.pkgReturn}"></td>
                        </tr>
                        <tr >
                            <td><strong>Package Contents</strong></td>
                            <td style="text-align:left; font-size:14px;" th:text="${pkgDto.pkgContents}"></td>
                        </tr>
                      </tbody>
                    </table>

              </div>
            </div>
        </div>
        <hr>
        <div>
          <a href=""  th:href="@{/reservation/reservation(pkgName=${pkgDto.pkgName})}" class="btn btn-outline-dark mt-5 p-4 sessionCheck btnGoReserv" id="btnCurrentReserv"
          >Let's Go for Reservation</a>
        </div>
        <hr>
        <div class="row">
            <div class="card card-border-light col border-white">
                <img th:src="@{|/upload/${pkgSubImgDto.subImg01}|}" class="card-img-top packageDetailImage" alt="...">
              </div>
            <div class="card card-border-light col border-white">
                <img th:src="@{|/upload/${pkgSubImgDto.subImg02}|}" class="card-img-top packageDetailImage" alt="...">
              </div>
            <div class="card card-border-light col border-white">
                <img th:src="@{|/upload/${pkgSubImgDto.subImg03}|}" class="card-img-top packageDetailImage" alt="...">
              </div>
            <div class="card card-border-light col border-white">
                <img th:src="@{|/upload/${pkgSubImgDto.subImg04}|}" class="card-img-top packageDetailImage" alt="...">
              </div>
        </div>
        <div class="row" style="margin-top:10px;">
            <div class="card card-border-light col border-white">
                <img th:src="@{|/upload/${pkgSubImgDto.subImg05}|}" class="card-img-top packageDetailImage" alt="...">
              </div>
            <div class="card card-border-light col border-white">
                <img th:src="@{|/upload/${pkgSubImgDto.subImg06}|}" class="card-img-top packageDetailImage" alt="...">
              </div>
            <div class="card card-border-light col border-white">
                <img th:src="@{|/upload/${pkgSubImgDto.subImg07}|}" class="card-img-top packageDetailImage" alt="...">
              </div>
            <div class="card card-border-light col border-white">
                <img th:src="@{|/upload/${pkgSubImgDto.subImg08}|}" class="card-img-top packageDetailImage" alt="...">
              </div>


            <div class="row mt-5">
              <div class="col-7 mt-5">
                <h3>Review List</h3>
                <hr>
                <table width="100%" class="table" id="reviewTable">
                  <thead>
                    <tr class="table-dark" style="font-weight:700;">
                      <th>User Rating</th>
                      <th>Title</th>
                      <th>Writer</th>
                      <th>Date</th>
                    </tr>
                  </thead>
                  <tbody th:each="item : ${reviewList}">
                    <tr id="selectedReview" th:data-no="${item.reviewNo}" class="btn-outline-secondary" style="color:black">
                      <td th:text="${item.ratingAVG}" style="color:#ccac00; font-weight: 700;"></td>
                      <td th:text="${item.reviewTitle}" style="font-weight: 700;"></td>
                      <td th:text="${item.reviewName}" style="font-weight: 700;"></td>
                      <td th:text="${item.reviewDate}"></td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="col-5 mt-5" id="reviewDetails">
              </div>
            </div>
      <script>
        $("#reviewTable").on("click", "#selectedReview",function () {
          // const reviewNo = $(this).data("no");
          const sendData = {
            reviewNo: $(this).data("no"),
          };
          $.ajax({
            url: "/package/getSelectedReview",
            data: sendData,
            type: "POST",
            success: function (response) {
              console.log(response);
              let tempHtml = "";
                tempHtml += `
                <h3>ㅤ</h3>
                <hr>
                <table width="100%" class="table table-bordered" id="reviewTable" style="border-color:#8c8e90;">
                  <thead>
                    <tr class="table-dark" style="font-weight:700;">
                      <th width="35%">Rating Details</th>
                      <th>Review Contents</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td class="text-start" style="font-size:13px;">
                      <strong>General Service: </strong><p style="color:#ccac00; font-size:16px; font-weight:700; text-align:right; margin:0;">${response.ratingGS}/5</p>
                      <br>
                      <strong>Food & Accommodation: </strong><p style="color:#ccac00; font-size:16px; font-weight:700; text-align:right; margin:0;">${response.ratingFA}/5</p>
                      <br>
                      <strong>Cost-Effectiveness: </strong><p style="color:#ccac00; font-size:16px; font-weight:700; text-align:right; margin:0;">${response.ratingCE}/5</p>
                      </td>
                      <td class="text-start"><br><span style="font-size: 14px; color:black;">${response.reviewContents}</span></td>
                    </tr>
                  </tbody>
                </table>
                `;
              $("#reviewDetails").html(tempHtml);
            },
          });
        });        
      </script>
    </div>
  </body>
</html>

